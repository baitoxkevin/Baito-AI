# Excel Vision Extractor Module Configuration
# Generated by BMad Builder on 2025-10-08
# Author: Kevin

module_name: "Excel Vision Extractor"
module_code: "excel-extract"
version: "1.0.0"
description: "Automated extraction and validation of candidate/project data from complex Excel sheets using AI vision analysis with multi-phase verification"

# Module paths
module_root: "{project-root}/bmad/excel-extract"
installer_path: "{project-root}/bmad/excel-extract"

# Component inventory
agents:
  count: 4
  list:
    - data-extraction-orchestrator
    - vision-analyzer
    - validation-specialist
    - supabase-import-manager

workflows:
  count: 5
  list:
    - full-extraction
    - vision-analysis
    - data-verification
    - mastersheet-generator
    - supabase-import

tasks:
  count: 3
  list:
    - receipt-extractor
    - n8n-webhook-caller
    - chrome-screenshot

# Excel extraction settings
extraction:
  # API Configuration
  gemini_api_key: "{env}:GEMINI_API_KEY"
  gemini_model: "gemini-2.0-flash-exp"

  # n8n Integration
  n8n_webhook_url: "{env}:N8N_WEBHOOK_URL"
  n8n_enabled: false  # Set to true when n8n workflows are ready

  # Chrome DevTools MCP
  chrome_mcp_enabled: true
  chrome_screenshot_timeout: 30000

  # Processing settings
  rate_limit_delay: 15  # seconds between API calls
  max_retries: 3
  timeout: 180  # seconds for API requests

  # Masterlist configuration
  masterlist_columns:
    - fullname
    - ic
    - bank
    - bank_no
    - project_name
    - project_date
    - project_time
    - wages
    - hour_wages
    - ot
    - claims
    - allowance
    - commission
    - total_payment
    - payment_date
    - working_time
    - project_pic
    - project_venue
    - source_file
    - source_sheet
    - source_row
    - confidence
    - verification_status
    - notes

# Output configuration
output_folder: "{project-root}/excel_extraction_results"
data_folder: "{module_root}/data"
screenshots_folder: "{project-root}/excel_screenshots"
receipts_folder: "{project-root}/excel_receipts"
n8n_templates_folder: "{module_root}/n8n-templates"

# Verification rules
verification:
  calculation_check: true  # Verify wages + ot + claims + allowance + commission = total
  duplicate_check: true    # Check for duplicate ICs
  ic_format_validation: true
  bank_number_validation: true
  required_fields:
    - fullname
    - ic
    - project_name
    - total_payment

# Supabase integration
supabase:
  url: "{env}:SUPABASE_URL"
  anon_key: "{env}:SUPABASE_ANON_KEY"
  table_name: "candidates"
  batch_size: 50
  dry_run_default: true  # Always start with dry run for safety

# Module metadata
tags:
  - data-extraction
  - excel-processing
  - ai-vision
  - validation
  - supabase
  - automation

target_audience:
  - event-management-teams
  - hr-departments
  - project-managers
  - data-migration-specialists

dependencies:
  external_apis:
    - google-gemini-vision
    - supabase
  mcp_tools:
    - chrome-devtools
    - n8n (optional)
  python_libraries:
    - openpyxl
    - requests
    - Pillow
